<div class="container">
    <div class="card shadow-sm w-75 mx-auto">
        <h4 class="card-header text-white">{{ 'Informações do Doador' }}</h4>
        <div class="card-body p-3">
            <h5>{{ `Nome: ${doador()?.nome}` }}</h5>
            <h6>{{
                `Documento de identificação: ${doador()?.docIdentificacao ?? 0 | mask:
                doador()?.docIdentificacao?.length == 11
                ? '000.000.000-00'
                : '00.000.000/0000-00'}`
                }}</h6>
            <h6>{{ `Email: ${doador()?.email}` }}</h6>
            <hr class="hr" />
            <div class="d-flex justify-content-end align-items-center gap-3">
                <button type="button" class="btn app-btn-red col-3" (click)="deleteDoador()">
                    Deletar Cadastro
                </button>
                <button type="button" class="btn app-btn-blue col-3" (click)="updateDoadorModal()">
                    Atualizar Dados
                </button>
            </div>
        </div>
    </div>
    <div class="card shadow-sm w-75 mx-auto mt-3">
        <h4 class="card-header text-white">Doações</h4>
        <div class="card-body p-0">
            @if (!doador() || doador()?.doacoes?.length === 0) {
            <div class="text-center text-muted py-3">
                Nenhum registro encontrado.
            </div>
            } @else {
            <div class="table-responsive">
                <table class="table table-striped table-hover table-sm align-middle">
                    <thead class="table-light">
                        <tr>
                            <th scope="col" class="col-1">ID</th>
                            <th scope="col" class="col">Comentário</th>
                            <th scope="col" class="col-2">Data</th>
                            <th scope="col" class="col-3">Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        @for (doacao of doador()?.doacoes; track $index) {
                        <tr>
                            <td>{{ doacao.id }}</td>
                            <td>{{ doacao.descricao }}</td>
                            <td>{{ doacao.data }}</td>
                            <td>
                                <a class="btn btn-sm btn-outline-primary me-1" [routerLink]="['/doacao', doacao.id]">
                                    Ver Detalhes
                                </a>
                                <a class="btn btn-sm btn-outline-danger" (click)="removeDoacao(doacao.id)">
                                    Excluir
                                </a>
                            </td>
                        </tr>
                        }
                    </tbody>
                </table>
            </div>
            }
        </div>
    </div>
</div>

<app-modal [title]="'Adicionar Item'" [isOpen]="showUpdateDoadorModal" [fade]="true" [customFooter]="true"
    (onClose)="showUpdateDoadorModal = false">
    <form [formGroup]="updateDoadorForm" class="row g-3" (ngSubmit)="updateDoador()">
        <app-input formControlName="nome" [label]="'Nome'" [errorMessage]="getErrorMessage('nome')"
            [submitted]="submitted"></app-input>
        <app-input formControlName="email" [label]="'Email'" [errorMessage]="getErrorMessage('email')"
            [submitted]="submitted"></app-input>
        <div modal-footer class="d-flex justify-content-end gap-2">
            <button type="submit" class="btn app-btn-blue">Salvar</button>
            <button type="button" class="btn app-btn-red" (click)="showUpdateDoadorModal = false">
                Cancelar
            </button>
        </div>
    </form>
</app-modal>